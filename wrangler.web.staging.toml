name = "msgstats-web-staging"
compatibility_date = "2026-01-01"
compatibility_flags = ["nodejs_compat"]
main = "workers/web/worker.ts"

# Bind this worker to the staging hostname route in your zone.
# This prevents Wrangler from removing the Dashboard route on deploy.
routes = [
  { pattern = "staging.msgstats.from-trees.com/*", zone_name = "from-trees.com" },
]

[vars]
META_REDIRECT_URI = "https://staging.msgstats.from-trees.com/api/auth/callback"
META_SCOPES = "pages_show_list,pages_messaging,pages_read_engagement,pages_manage_metadata,business_management,instagram_basic,instagram_manage_messages"

[assets]
directory = "./build/client"

[[durable_objects.bindings]]
name = "SYNC_RUNS_HUB"
class_name = "SyncRunsHub"

[[migrations]]
tag = "v1"
new_classes = ["SyncRunsHub"]

[[services]]
binding = "API"
service = "msgstats-api-staging"

[observability]
[observability.logs]
enabled = true
invocation_logs = true